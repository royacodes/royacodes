یکی از بزرگ‌ترین دغدغه‌های برنامه‌نویسان در ایران، ناپایداری شبکه‌های ارتباطی، تحریم‌های سرویس‌دهنده‌های خارجی و قطعی‌های گاه‌وبی‌گاه اینترنت است. وقتی صحبت از اختلال اینترنت در برنامه‌نویسی می‌شود، با دو سناریوی کاملاً متفاوت روبه‌رو هستیم:

**قطعی اینترنت بین‌الملل (یا تحریم):** دسترسی به سرورهای خارجی مسدود است، اما شبکه داخلی (اینترنت ملی) کار می‌کند. در این حالت راهکار اصلی استفاده از **میرورها (Mirrors)** و **رجیستری‌های جایگزین** است.

**قطعی کامل اینترنت:** سیستم شما به هیچ شبکه‌ای متصل نیست. در این حالت راهکار اصلی استفاده از **حافظه کش (Cache)** سیستم و **حالت‌های Offline** است.

در این مقاله، راهکارهای عبور از این دو بحران را برای چهار پلتفرم و تکنولوژی محبوب بررسی می‌کنیم.

---

## ۱. فلاتر (Flutter)

فلاتر برای دریافت پکیج‌ها و SDK به شدت به سرورهای گوگل وابسته است.

### الف) در زمان قطعی اینترنت بین‌الملل (استفاده از Mirror)

برای دور زدن تحریم‌ها یا دسترسی در زمان اینترنت ملی، باید آدرس سرورهای پیش‌فرض فلاتر را به سرورهای میرور تغییر دهید. این کار با تنظیم **متغیرهای محیطی (Environment Variables)** انجام می‌شود:

- **متغیر `PUB_HOSTED_URL`:** آدرس سرور دانلود پکیج‌ها (جایگزین `pub.dev`).
- **متغیر `FLUTTER_STORAGE_BASE_URL`:** آدرس سرور دانلود فایل‌های هسته فلاتر.

شما می‌توانید این متغیرها را با آدرس میرورهای معتبر چینی (مثل دانشگاه تسینگهوا) یا سرورهای آینه‌ای ایرانی مقداردهی کنید.

### ب) در زمان قطعی کامل اینترنت (حالت Offline)

اگر قبلاً پکیج‌ها را دانلود کرده‌اید، فلاتر آن‌ها را در مسیر `.pub-cache` ذخیره کرده است. برای اینکه فلاتر بدون چک کردن اینترنت از این فایل‌ها استفاده کند، از دستور زیر استفاده کنید:

```bash
flutter pub get --offline
```

---

## ۲. توسعه وب و ری‌اکت (React / Node.js)

در دنیای جاوا اسکریپت، ابزارهایی مثل npm، Yarn یا pnpm وظیفه مدیریت پکیج‌ها را دارند.

### الف) در زمان قطعی اینترنت بین‌الملل (تغییر Registry)

آدرس پیش‌فرض دانلود پکیج‌ها `registry.npmjs.org` است. شما می‌توانید این آدرس را به یک رجیستری جایگزین (میرور) تغییر دهید.

**تغییر در npm:**

```bash
npm config set registry https://registry.npmmirror.com
```

برای بازگشت به حالت اول:

```bash
npm config delete registry
```

### ب) در زمان قطعی کامل اینترنت (Cache آفلاین)

بسته به پکیج‌منیجری که استفاده می‌کنید، می‌توانید سیستم را مجبور کنید که فقط از حافظه کش محلی بخواند:

- **برای npm:** `npm install --prefer-offline --no-audit`
- **برای Yarn (بسیار پایدارتر):** `yarn install --offline`
- **برای pnpm:** `pnpm install --offline`

---

## ۳. اندروید نیتیو (Android Studio / Kotlin / Gradle)

سیستم بیلد اندروید (Gradle) یکی از حساس‌ترین ابزارها نسبت به اینترنت است و تحریم‌های گوگل نیز کار را سخت‌تر می‌کند.

### الف) در زمان قطعی اینترنت بین‌الملل

شما باید آدرس مخازنی که گریدل از آن‌ها کتابخانه‌ها را دانلود می‌کند تغییر دهید:

- **میرور کردن Repositoryها:** در فایل `settings.gradle` یا `build.gradle`، آدرس‌هایی مثل `google()` و `mavenCentral()` را با آدرس میرورهای چینی (مثل Aliyun) جایگزین کنید.
- **تنظیمات Gradle Wrapper:** در فایل `gradle-wrapper.properties`، آدرس `distributionUrl` را به یک میرور معتبر برای دانلود فایل zip گریدل تغییر دهید.

> **نکته:** استفاده از DNSهای ضدتحریم ایرانی معمولاً راهکار بی‌دردسرتری نسبت به تغییر دستی مخازن اندروید است.

### ب) در زمان قطعی کامل اینترنت (Offline Mode)

اندروید استودیو قابلیتی داخلی برای کار با کش (در مسیر `.gradle/caches/`) دارد:

- **از طریق رابط کاربری:** در پنل سمت راست (Gradle)، روی آیکون **Toggle Offline Mode** (وای‌فایِ خط‌خورده) کلیک کنید.
- **از طریق ترمینال:** کلمه `--offline` را به دستور بیلد اضافه کنید:

```bash
./gradlew build --offline
```

---

## ۴. آی‌اواس (iOS / Xcode / Swift)

در iOS محدودیت‌های تحریمی اپل کمتر است، اما فیلترینگ گیت‌هاب یا قطعی بین‌الملل می‌تواند بیلد گرفتن را مختل کند.

### الف) در زمان قطعی اینترنت بین‌الملل

**برای CocoaPods:** در فایل `Podfile`، آدرس سورس را به یک میرور تغییر دهید:

```ruby
source 'https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git'
```

**برای SPM (Swift Package Manager):** اگر اینترنت بین‌الملل قطع است، باید پکیج را به صورت فایل ZIP دانلود کرده و به عنوان یک **پکیج Local** به اکس‌کد معرفی کنید.

### ب) در زمان قطعی کامل اینترنت

- **پوشه Pods:** تا زمانی که دستور `pod install` را اجرا نکنید و پوشه `Pods` و فایل `Podfile.lock` در پروژه شما موجود باشد، اکس‌کد به صورت کاملاً آفلاین پروژه را بیلد می‌گیرد.
- **کش SPM:** اکس‌کد پکیج‌های SPM را در مسیر `DerivedData` نگه می‌دارد. اگر اینترنت قطع شد، به هیچ وجه کش پروژه (**Clean Build Folder**) را پاک نکنید تا بیلد آفلاین با موفقیت انجام شود.

---

## راهکار طلایی برای تیم‌ها و شرکت‌ها (Local Registry)

اگر در یک شرکت یا تیم کار می‌کنید، تنظیم کردن دستی تک‌تک سیستم‌ها کار منطقی و پایداری نیست. بهترین راهکار برای شرکت‌های ایرانی، راه‌اندازی یک **رجیستری خصوصی (Local Registry)** درون‌شبکه‌ای است.

شما می‌توانید یکی از ابزارهای زیر را روی یک سرور داخلی شرکت نصب کنید:

- **Verdaccio:** مخصوص پروژه‌های وب و Node.js.
- **Nexus Repository Manager** یا **JFrog Artifactory:** یک راهکار جامع که می‌تواند مخزن مرکزی برای همه تکنولوژی‌ها (npm، Gradle، CocoaPods، پکیج‌های فلاتر و Docker) باشد.

**نحوه کار:** یک بار که یکی از برنامه‌نویسان (یا سرور بیلد) پکیجی را با اینترنت دانلود کند، این ابزار آن را در سرور داخلی شرکت ذخیره می‌کند. از آن به بعد، حتی اگر اینترنت کل کشور قطع شود، تمام برنامه‌نویسان شرکت می‌توانند پکیج‌ها را با سرعت شبکه محلی (LAN) از سرور داخلی دریافت کنند.
